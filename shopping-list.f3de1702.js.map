{"mappings":"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","sources":["node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/runtime-650f3f31d1daefc7.js","src/shopping-list-main.js","src/js/shopping-list.js","node_modules/@parcel/runtime-js/lib/runtime-3bd641e50b9ed884.js","node_modules/@parcel/runtime-js/lib/runtime-8e0234439d89b2f0.js","node_modules/@parcel/runtime-js/lib/runtime-e1a988f64613cab5.js","node_modules/@parcel/runtime-js/lib/runtime-edbb01eeda80afe6.js","node_modules/@parcel/runtime-js/lib/runtime-bc54bb2571c9072b.js","node_modules/@parcel/runtime-js/lib/runtime-08d125d79a9d4377.js","node_modules/@parcel/runtime-js/lib/runtime-0d3c294a37fac635.js","node_modules/@parcel/runtime-js/lib/runtime-44e7bd74d9a8b620.js"],"sourcesContent":["\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"hbTCY\\\":\\\"shopping-list.f3de1702.js\\\",\\\"4OOBK\\\":\\\"mobile.a9653c9a.png\\\",\\\"8Tym4\\\":\\\"mobile@2x.a472d73e.png\\\",\\\"gr3Am\\\":\\\"tablet-desck.fed7a1f9.png\\\",\\\"cfk6k\\\":\\\"tablet-desck@2x.24f1324d.png\\\",\\\"6IByG\\\":\\\"amazon.b8fa90cb.png\\\",\\\"afe81\\\":\\\"apple-books.5a9f17e3.png\\\",\\\"kJjGN\\\":\\\"bookshop.91914384.png\\\",\\\"8OQ7p\\\":\\\"icons.58cb19ae.svg\\\",\\\"1XaNB\\\":\\\"index.7945747b.css\\\",\\\"hE9ny\\\":\\\"index.67ed9195.js\\\"}\"));","import './js/header.js';\nimport './js/support-ukraine.js';\n\nimport './js/shopping-list.js';\nimport './js/theme.js';\n","import { Notify } from 'notiflix/build/notiflix-notify-aio';\nimport booksApiService from './books-service';\nimport { save, load, LOCAL_STORAGE_KEY } from './storage';\nimport mobileImg from '../images/shopping-list/mobile.png';\nimport mobileREtinaImg from '../images/shopping-list/mobile@2x.png';\nimport tabletDeskImg from '../images/shopping-list/tablet-desck.png';\nimport tabletDesckRetinaImg from '../images/shopping-list/tablet-desck@2x.png';\nimport amazonImg from '../images/books-links/amazon.png';\nimport appleImg from '../images/books-links/apple-books.png';\nimport bookshopImg from '../images/books-links/bookshop.png';\nimport sprite from '../images/icons.svg';\nimport loadingToogle from './loader';\n\nconst refs = {\n  listEl: document.querySelector('.js-shopping-list'),\n};\n\nconst savedBooks = load(LOCAL_STORAGE_KEY);\nconst booksId = savedBooks ? savedBooks : [];\n\nif (!booksId.length) {\n  refs.listEl.innerHTML = createDefault();\n} else {\n  getBooks(booksId);\n}\n\nasync function getBooks(ids) {\n  loadingToogle();\n  try {\n    const booksPromise = ids.map(id => booksApiService.fetchBookById(id));\n    const result = await Promise.allSettled(booksPromise);\n    const books = result.map(({ value }) => value);\n    const markup = createBooksMarkup(books);\n    refs.listEl.innerHTML = markup;\n    refs.listEl.addEventListener('click', handlerRemove);\n  } catch (error) {\n    Notify.failure('HTTP request failed');\n  }\n  loadingToogle();\n}\n\nfunction handlerRemove(e) {\n  const booksId = load(LOCAL_STORAGE_KEY);\n  if (!e.target.closest('.js-remove')) {\n    return;\n  }\n  const id = e.target.closest('[id]').id;\n  refs.listEl.querySelector(`[data-id='${id}']`).remove();\n  const updateBooksId = booksId.filter(bookId => bookId !== id);\n  save(LOCAL_STORAGE_KEY, updateBooksId);\n  if (!load(LOCAL_STORAGE_KEY).length) {\n    refs.listEl.innerHTML = createDefault();\n  }\n}\n\nfunction createBooksMarkup(books) {\n  console.log(books);\n  return books\n    .map(\n      ({\n        _id,\n        book_image,\n        list_name,\n        description,\n        author,\n        buy_links,\n        title,\n      }) => {\n        const amazonLink = buy_links.find(({ name }) =>\n          name.toLowerCase().includes('amazon')\n        ).url;\n        const appleBooksLink = buy_links.find(({ name }) =>\n          name.toLowerCase().includes('apple')\n        ).url;\n        const bookshopLink = buy_links.find(({ name }) =>\n          name.toLowerCase().includes('bookshop')\n        ).url;\n        return `\n     <li data-id=\"${_id}\" class=\"js-book shopping-list-js-book\"><div class=\"shopping-list-book-image-wrapper\"><img src=\"${book_image}\" alt=\"${title}\" class=\"shopping-list-book-image\" width=\"\" height=\"\"/></div><div><h2 class=\"shopping-list-title-book\">${title}</h2><p class=\"shopping-list-list-name\">${list_name}</p><p class=\"shopping-list-description\">${description}</p><div class=\"shopping-list-author-links\"><p class=\"shopping-list-book-author\">${author}</p><ul class=\"shopping-list-links-list\"><li><a href=\"${amazonLink}\" class=\"shopping-list-links-icon-amazon\" target=\"_blank\" rel=\"noreferrer noopener\"><img src=\"${amazonImg}\" alt=\"icon of Amazon\" width=\"\" height=\"\"/></a></li><li><a href=\"${appleBooksLink}\" class=\"shopping-list-links-icon-apple\" target=\"_blank\" rel=\"noreferrer noopener\"><img src=\"${appleImg}\" alt=\"icon of Apple-books\" width=\"\" height=\"\" /></a></li><li><a href=\"${bookshopLink}\" class=\"shopping-list-links-icon\" target=\"_blank\" rel=\"noreferrer noopener\"><img src=\"${bookshopImg}\" alt=\"icon of bookshop\" width=\"\" height=\"\" /></a></li></ul></div><button id=${_id} class=\"js-remove shopping-list-btn-remove\" type= \"button\"><svg class=\"icon-remove shopping-list-icon-remove\" width=\"18px\" height=\"18px\"><use href=\"${sprite}#icon-dump\"></use></svg></button></div></li>`;\n      }\n    )\n    .join('');\n}\n\nfunction createDefault() {\n  return `<div class=\"shopping-list-default\"><p class=\"shopping-list-default-message\">This page is empty, add some books and proceed to order.</p><picture><source\n          srcset=\"${tabletDeskImg} 1x, ${tabletDesckRetinaImg} 2x\"\n          media=\"(min-width: 768px)\"\n        />\n        <source\n          srcset=\"\n            ${mobileImg}   1x,\n            ${mobileREtinaImg} 2x\n          \"\n          media=\"(min-width: 320px)\"\n        />\n        <img\n          src=\"${mobileImg}\"\n          class=\"shopping-list-default-picture\"\n          alt=\"stack of books\"\n          width=\"265\"\n          height=\"198\"\n        />\n      </picture>\n          </div>`;\n}\n","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"4OOBK\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"8Tym4\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"gr3Am\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"cfk6k\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"6IByG\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"afe81\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"kJjGN\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"8OQ7p\")).toString();"],"names":["$ef7689007096c8a0$export$6503ec6e8aabbaf","$ef7689007096c8a0$export$f7ad0328861e2f03","$ef7689007096c8a0$var$mapping","pairs","keys","Object","i","length","id","resolved","Error","parcelRequire","register","JSON","parse","$iQIUW","$3116910b64229b02$exports","URL","resolve","import","meta","url","toString","$beb8c037863c4c08$exports","$01af40cc12078c49$exports","$a1d3b213610fa850$exports","$65970de47bfa3267$exports","$d1199dbd2c1bb57b$exports","$6fb417964fc09b73$exports","$e27edc6dc33d0133$exports","$e5c62ffd1c5d842f$var$refs","listEl","document","querySelector","$e5c62ffd1c5d842f$var$savedBooks","$5uEKZ","load","LOCAL_STORAGE_KEY","$e5c62ffd1c5d842f$var$booksId","$e5c62ffd1c5d842f$var$handlerRemove","e","booksId1","target","closest","remove","updateBooksId","filter","bookId","save","innerHTML","$e5c62ffd1c5d842f$var$createDefault","$parcel$interopDefault","async","ids","$gjiCh","default","booksPromise","map","$e7MOj","fetchBookById","result","Promise","allSettled","markup","books","console","log","_id","book_image","list_name","description","author","buy_links","title","amazonLink","find","name","toLowerCase","includes","appleBooksLink","bookshopLink","join","$e5c62ffd1c5d842f$var$createBooksMarkup","value","addEventListener","error","Notify","failure","$e5c62ffd1c5d842f$var$getBooks"],"version":3,"file":"shopping-list.f3de1702.js.map"}