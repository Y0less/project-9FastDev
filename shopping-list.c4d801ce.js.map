{"mappings":"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","sources":["node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/runtime-650f3f31d1daefc7.js","src/shopping-list-main.js","src/js/shopping-list.js","node_modules/@parcel/runtime-js/lib/runtime-3bd641e50b9ed884.js","node_modules/@parcel/runtime-js/lib/runtime-8e0234439d89b2f0.js","node_modules/@parcel/runtime-js/lib/runtime-e1a988f64613cab5.js","node_modules/@parcel/runtime-js/lib/runtime-edbb01eeda80afe6.js","node_modules/@parcel/runtime-js/lib/runtime-bc54bb2571c9072b.js","node_modules/@parcel/runtime-js/lib/runtime-08d125d79a9d4377.js","node_modules/@parcel/runtime-js/lib/runtime-0d3c294a37fac635.js","node_modules/@parcel/runtime-js/lib/runtime-44e7bd74d9a8b620.js"],"sourcesContent":["\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"hbTCY\\\":\\\"shopping-list.c4d801ce.js\\\",\\\"4OOBK\\\":\\\"mobile.a9653c9a.png\\\",\\\"8Tym4\\\":\\\"mobile@2x.a472d73e.png\\\",\\\"gr3Am\\\":\\\"tablet-desck.fed7a1f9.png\\\",\\\"cfk6k\\\":\\\"tablet-desck@2x.24f1324d.png\\\",\\\"6IByG\\\":\\\"amazon.b8fa90cb.png\\\",\\\"afe81\\\":\\\"apple-books.5a9f17e3.png\\\",\\\"kJjGN\\\":\\\"bookshop.91914384.png\\\",\\\"8OQ7p\\\":\\\"icons.d964f32e.svg\\\",\\\"1XaNB\\\":\\\"index.2823627f.css\\\",\\\"hE9ny\\\":\\\"index.f9f53d1b.js\\\"}\"));","import './js/header.js';\nimport './js/support-ukraine.js';\n\nimport './js/shopping-list.js';\nimport './js/theme.js';\nimport './js/login-modal.js';\n\nconst activePageLink = document.querySelector('.active-page');\nif (activePageLink) {\n  activePageLink.classList.remove('active-page');\n}\n\nconst activePageLinkMobile = document.querySelector(\n  '.modal-nav-link.active-page'\n);\nif (activePageLinkMobile) {\n  activePageLinkMobile.classList.remove('active-page');\n}\n\ndocument.querySelector('.js-shopping-list-page').classList.add('active-page');\ndocument\n  .querySelector('.js-shopping-list-page-mobile')\n  .classList.add('active-page');\n","import { Notify } from 'notiflix/build/notiflix-notify-aio';\nimport booksApiService from './books-service';\nimport { save, load, LOCAL_STORAGE_KEY } from './storage';\nimport mobileImg from '../images/shopping-list/mobile.png';\nimport mobileREtinaImg from '../images/shopping-list/mobile@2x.png';\nimport tabletDeskImg from '../images/shopping-list/tablet-desck.png';\nimport tabletDesckRetinaImg from '../images/shopping-list/tablet-desck@2x.png';\nimport amazonImg from '../images/books-links/amazon.png';\nimport appleImg from '../images/books-links/apple-books.png';\nimport bookshopImg from '../images/books-links/bookshop.png';\nimport sprite from '../images/icons.svg';\nimport loadingToogle from './loader';\n\nconst refs = {\n  listEl: document.querySelector('.js-shopping-list'),\n  prevButton: document.querySelector('.pagination-prev'),\n  nextButton: document.querySelector('.pagination-next'),\n  currentSpan: document.querySelector('.pagination-current'),\n};\nrefs.prevButton.addEventListener('click', handlePrevClick);\nrefs.nextButton.addEventListener('click', handleNextClick);\nconst booksPerPage = 3;\nlet currentPage = 1;\n\nconst savedBooks = load(LOCAL_STORAGE_KEY);\nconst booksId = savedBooks ? savedBooks : [];\n\nif (!booksId.length) {\n  refs.listEl.innerHTML = createDefault();\n  hidePagination();\n} else {\n  getBooks(booksId);\n  showPagination();\n}\n\nasync function getBooks(ids) {\n  loadingToogle();\n  try {\n    const booksPromise = ids.map(id => booksApiService.fetchBookById(id));\n    const result = await Promise.allSettled(booksPromise);\n    const books = result\n      .filter(({ status }) => status === 'fulfilled')\n      .map(({ value }) => value);\n\n    const totalBooks = books.length;\n    const totalPages = Math.ceil(totalBooks / booksPerPage);\n\n    const startIndex = (currentPage - 1) * booksPerPage;\n    const endIndex = startIndex + booksPerPage;\n    const booksToShow = books.slice(startIndex, endIndex);\n\n    const markup = createBooksMarkup(booksToShow);\n    refs.listEl.innerHTML = markup;\n    refs.listEl.addEventListener('click', handlerRemove);\n\n    updatePagination(currentPage, totalPages);\n  } catch (error) {\n    Notify.failure('HTTP request failed');\n  }\n  loadingToogle();\n}\n\nfunction handlerRemove(e) {\n  const booksId = load(LOCAL_STORAGE_KEY);\n  if (!e.target.closest('.js-remove')) {\n    return;\n  }\n  const id = e.target.closest('[data-id]').dataset.id;\n  refs.listEl.querySelector(`[data-id='${id}']`).remove();\n\n  const updateBooksId = booksId.filter(bookId => bookId !== id);\n  save(LOCAL_STORAGE_KEY, updateBooksId);\n\n  if (!load(LOCAL_STORAGE_KEY).length) {\n    refs.listEl.innerHTML = createDefault();\n\n    currentPage = 1;\n    const totalPages = 1;\n    updatePagination(currentPage, totalPages);\n    hidePagination();\n\n    const pagination = document.querySelector('.pagination');\n    pagination.classList.add('hidden');\n  } else {\n    const totalBooks = updateBooksId.length;\n    const totalPages = Math.ceil(totalBooks / booksPerPage);\n\n    if (currentPage > totalPages) {\n      currentPage = totalPages;\n    }\n\n    getBooks(updateBooksId);\n    updatePagination(currentPage, totalPages);\n\n    refs.listEl.classList.remove('shopping-list-empty');\n    const pagination = document.querySelector('.pagination');\n    pagination.classList.remove('hidden');\n  }\n}\n\nrefs.prevButton.addEventListener('click', handlePrevClick);\nrefs.nextButton.addEventListener('click', handleNextClick);\n\nfunction hidePagination() {\n  const pagination = document.querySelector('.pagination');\n  pagination.style.display = 'none';\n};\n\nfunction showPagination() {\n  const pagination = document.querySelector('.pagination');\n  pagination.style.display = 'flex';\n}\n\nfunction createBooksMarkup(books) {\n  return books\n    .map(\n      ({\n        _id,\n        book_image,\n        list_name,\n        description,\n        author,\n        buy_links,\n        title,\n      }) => {\n        const amazonLink = buy_links.find(({ name }) =>\n          name.toLowerCase().includes('amazon')\n        ).url;\n        const appleBooksLink = buy_links.find(({ name }) =>\n          name.toLowerCase().includes('apple')\n        ).url;\n        const bookshopLink = buy_links.find(({ name }) =>\n          name.toLowerCase().includes('bookshop')\n        ).url;\n        return `\n     <li data-id=\"${_id}\" class=\"js-book shopping-list-js-book\"><div class=\"shopping-list-book-image-wrapper\"><img src=\"${book_image}\" alt=\"${title}\" class=\"shopping-list-book-image\" width=\"\" height=\"\"/></div><div><h2 class=\"shopping-list-title-book\">${title}</h2><p class=\"shopping-list-list-name\">${list_name}</p><p class=\"shopping-list-description\">${description}</p><div class=\"shopping-list-author-links\"><p class=\"shopping-list-book-author\">${author}</p><ul class=\"shopping-list-links-list\"><li><a href=\"${amazonLink}\" class=\"shopping-list-links-icon-amazon\" target=\"_blank\" rel=\"noreferrer noopener\"><img src=\"${amazonImg}\" alt=\"icon of Amazon\" width=\"\" height=\"\"/></a></li><li><a href=\"${appleBooksLink}\" class=\"shopping-list-links-icon-apple\" target=\"_blank\" rel=\"noreferrer noopener\"><img src=\"${appleImg}\" alt=\"icon of Apple-books\" width=\"\" height=\"\" /></a></li><li><a href=\"${bookshopLink}\" class=\"shopping-list-links-icon\" target=\"_blank\" rel=\"noreferrer noopener\"><img src=\"${bookshopImg}\" alt=\"icon of bookshop\" width=\"\" height=\"\" /></a></li></ul></div><button data-id=\"${_id}\" class=\"js-remove shopping-list-btn-remove\" type=\"button\"><svg class=\"icon-remove shopping-list-icon-remove\" width=\"18px\" height=\"18px\"><use href=\"${sprite}#icon-dump\"></use></svg></button></div></li>`;\n      }\n    )\n    .join('');\n}\n\nfunction createDefault() {\n  return `<div class=\"shopping-list-default\"><p class=\"shopping-list-default-message\">This page is empty, add some books and proceed to order.</p><picture><source\n          srcset=\"${tabletDeskImg} 1x, ${tabletDesckRetinaImg} 2x\"\n          media=\"(min-width: 768px)\"\n        />\n        <source\n          srcset=\"${mobileImg} 1x, ${mobileREtinaImg} 2x\"\n          media=\"(min-width: 320px)\"\n        />\n        <img\n          src=\"${mobileImg}\"\n          class=\"shopping-list-default-picture\"\n          alt=\"stack of books\"\n          width=\"265\"\n          height=\"198\"\n        />\n      </picture>\n    </div>`;\n}\n\nfunction updatePagination(currentPage, totalPages) {\n  const prevButton = document.querySelector('.pagination-prev');\n  const nextButton = document.querySelector('.pagination-next');\n  const currentSpan = document.querySelector('.pagination-current');\n  const totalSpan = document.querySelector('.pagination-total');\n\n  currentSpan.textContent = currentPage;\n  totalSpan.textContent = `of ${totalPages}`;\n\n  if (currentPage === 1) {\n    prevButton.disabled = true;\n  } else {\n    prevButton.disabled = false;\n  }\n\n  if (currentPage === totalPages) {\n    nextButton.disabled = true;\n  } else {\n    nextButton.disabled = false;\n  }\n}\n\nfunction handlePrevClick() {\n  if (currentPage > 1) {\n    currentPage--;\n    getBooks(booksId);\n  }\n}\n\nfunction handleNextClick() {\n  const totalBooks = booksId.length;\n  const totalPages = Math.ceil(totalBooks / booksPerPage);\n\n  if (currentPage < totalPages) {\n    currentPage++;\n    getBooks(booksId);\n  }\n}\n\n","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"4OOBK\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"8Tym4\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"gr3Am\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"cfk6k\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"6IByG\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"afe81\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"kJjGN\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"8OQ7p\")).toString();"],"names":["$ef7689007096c8a0$export$6503ec6e8aabbaf","$ef7689007096c8a0$export$f7ad0328861e2f03","$ef7689007096c8a0$var$mapping","pairs","keys","Object","i","length","id","resolved","Error","parcelRequire","register","JSON","parse","$iQIUW","$3116910b64229b02$exports","URL","resolve","import","meta","url","toString","$beb8c037863c4c08$exports","$01af40cc12078c49$exports","$a1d3b213610fa850$exports","$65970de47bfa3267$exports","$d1199dbd2c1bb57b$exports","$6fb417964fc09b73$exports","$e27edc6dc33d0133$exports","$e5c62ffd1c5d842f$var$refs","listEl","document","querySelector","prevButton","nextButton","currentSpan","addEventListener","$e5c62ffd1c5d842f$var$handlePrevClick","$e5c62ffd1c5d842f$var$handleNextClick","$e5c62ffd1c5d842f$var$currentPage","$e5c62ffd1c5d842f$var$savedBooks","$5uEKZ","load","LOCAL_STORAGE_KEY","$e5c62ffd1c5d842f$var$booksId","async","$e5c62ffd1c5d842f$var$getBooks","ids","$gjiCh","default","booksPromise","map","$e7MOj","fetchBookById","books","Promise","allSettled","filter","status","value","totalBooks","totalPages","Math","ceil","startIndex","endIndex","markup","_id","book_image","list_name","description","author","buy_links","title","amazonLink","find","name","toLowerCase","includes","appleBooksLink","bookshopLink","$parcel$interopDefault","join","$e5c62ffd1c5d842f$var$createBooksMarkup","slice","innerHTML","$e5c62ffd1c5d842f$var$handlerRemove","$e5c62ffd1c5d842f$var$updatePagination","error","Notify","failure","e","booksId1","target","closest","dataset","remove","updateBooksId","bookId","save","classList","$e5c62ffd1c5d842f$var$createDefault","$e5c62ffd1c5d842f$var$hidePagination","add","style","display","currentPage1","totalSpan","textContent","disabled","$6e225bd309360fb4$var$activePageLink","$6e225bd309360fb4$var$activePageLinkMobile"],"version":3,"file":"shopping-list.c4d801ce.js.map"}